<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Compra Gu√≠a PAES M1 ‚Äì Veitman Publishing</title>
<meta name="description" content="Formulario de compra de la Gu√≠a PAES Matem√°ticas M1. Ingresa tu nombre y correo, confirma el correo y contin√∫a al pago seguro.">
<style>
  :root{
    --brand:#1e88a8;
    --brand-dark:#156f82;
    --bg:#e6f4f5;
  }
  html,body{margin:0;padding:0}
  body{font-family: Cambria, Georgia, 'Times New Roman', serif;background:var(--bg);color:#123;line-height:1.45}
  .wrap{max-width: 880px;margin: 32px auto;padding: 0 16px}
  header{display:flex;align-items:center;gap:12px;margin-bottom:12px}
  .logo{width:48px;height:48px;border-radius:12px;background: linear-gradient(135deg, #1e88a8, #38b2c5);display:flex;align-items:center;justify-content:center;color:#fff;font-weight:700;font-size:22px}
  h1{margin:8px 0 0 0;font-size:28px;color:var(--brand)}
  .card{background:#fff;border-radius:16px;box-shadow: 0 8px 24px rgba(0,0,0,.08);padding:24px}
  .row{display:grid;grid-template-columns:1fr 1fr;gap:16px}
  label{display:block;font-weight:700;margin:12px 0 6px}
  input[type="text"],input[type="email"]{width:100%;padding:12px 14px;border:1px solid #cfd8dc;border-radius:10px;font-size:16px}
  .hint{font-size:13px;color:#456;margin-top:4px}
  .price{background:#f7fbfc;border:1px dashed #cbe4ea;border-radius:12px;padding:12px 16px;margin:12px 0;font-size:16px}
  .agree{margin-top:12px;display:flex;gap:8px;align-items:flex-start}
  .agree input{margin-top:3px}
  .cta{margin-top:18px;display:flex;flex-wrap:wrap;gap:12px;align-items:center}
  button.primary, a.primary{
    background:var(--brand);color:#fff;border:none;padding:12px 20px;border-radius:10px;
    font-size:16px;cursor:pointer;text-decoration:none;display:inline-block
  }
  button.primary:disabled{opacity:.5;cursor:not-allowed}
  button.primary:hover, a.primary:hover{background:var(--brand-dark)}
  .msg{margin-top:10px;font-size:14px}
  .ok{color:#0a7a3f}
  .err{color:#b00020}
  footer{margin-top:18px;font-size:13px;color:#567}
  .small{font-size:12px;color:#678}
  @media (max-width:720px){
    .row{grid-template-columns:1fr}
  }
</style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="logo">VP</div>
      <div>
        <h1>Gu√≠a PAES Matem√°ticas M1</h1>
        <div class="small">Veitman Publishing ‚Äî Edici√≥n 2025</div>
      </div>
    </header>

    <div class="card">
      <div class="price"><strong>Precio:</strong> $9.990 CLP ¬∑ Pago con tarjeta o d√©bito v√≠a Mercado Pago</div>

      <form id="formCompra" novalidate>
        <div class="row">
          <div>
            <label for="nombre">Nombre completo</label>
            <input type="text" id="nombre" autocomplete="name" required>
          </div>
          <div>
            <label for="correo">Correo electr√≥nico</label>
            <input type="email" id="correo" autocomplete="email" required>
            <div class="hint">Usaremos este correo para enviarte el PDF</div>
          </div>
        </div>
        <div class="row">
          <div>
            <label for="correo2">Confirma tu correo</label>
            <input type="email" id="correo2" autocomplete="email" required>
          </div>
          <div>
            <label for="curso">Producto</label>
            <input type="text" id="curso" value="Gu√≠a PAES Matem√°ticas M1 (PDF digital)" readonly>
          </div>
        </div>

        <div class="agree">
          <input type="checkbox" id="ok" required>
          <label for="ok">Confirmo que mi correo es correcto y acepto recibir la gu√≠a por correo tras el pago</label>
        </div>

        <div class="cta">
          <button id="btnPagar" class="primary" type="button" disabled>Ir al pago seguro</button>
          <a id="linkPago" class="primary" href="#" target="_blank" rel="noopener" style="display:none">Abrir pago en nueva pesta√±a</a>
          <div id="estado" class="msg"></div>
        </div>
      </form>
      <footer>
        üí° Si el bot√≥n no funciona en tu navegador, te mostraremos un enlace alternativo para copiar y pegar
      </footer>
    </div>
    <footer class="small">
      Soporte: <a href="mailto:contacto.veitman@gmail.com">contacto.veitman@gmail.com</a>
    </footer>
  </div>

<script>
// ======= CONFIGURA AQU√ç =======
const MPAGO_LINK = "https://mpago.la/TU-LINK-DE-PAGO";     // <- reemplaza por tu link real
// La redirecci√≥n post-pago se define dentro de Mercado Pago (Back URL). Sugerencia: apunta a tu gracias.html
// ==============================

const $ = (sel)=>document.querySelector(sel);
const btn = $("#btnPagar");
const aPago = $("#linkPago");
const estado = $("#estado");

function emailsValidos(a,b){
  const re = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;
  return re.test(a) && re.test(b) && a===b;
}

function actualizarEstado(){
  const nombre = $("#nombre").value.trim();
  const e1 = $("#correo").value.trim();
  const e2 = $("#correo2").value.trim();
  const ok = $("#ok").checked;

  if(nombre && e1 && e2 && ok && emailsValidos(e1,e2)){
    btn.disabled = false;
    estado.textContent = "Tus datos est√°n listos para continuar al pago";
    estado.className = "msg ok";
  }else{
    btn.disabled = true;
    estado.textContent = "";
    estado.className = "msg";
  }
}

// eventos
["input","change"].forEach(evt=>{
  document.getElementById("formCompra").addEventListener(evt, actualizarEstado);
});

btn.addEventListener("click", ()=>{
  const nombre = $("#nombre").value.trim();
  const email = $("#correo").value.trim();
  const email2 = $("#correo2").value.trim();
  if(!emailsValidos(email,email2)){
    estado.textContent = "Revisa el correo y su confirmaci√≥n";
    estado.className = "msg err";
    return;
  }
  // Guarda en sessionStorage para mostrar en la p√°gina de gracias si quieres
  sessionStorage.setItem("vp_nombre", nombre);
  sessionStorage.setItem("vp_correo", email);

  // Activa fallback de enlace visible
  aPago.href = MPAGO_LINK;
  aPago.style.display = "inline-block";

  // Redirige al pago
  window.location.href = MPAGO_LINK;
});

// Prefill desde session/local storage si vuelve
window.addEventListener("DOMContentLoaded", ()=>{
  const n = sessionStorage.getItem("vp_nombre") || localStorage.getItem("vp_nombre") || "";
  const c = sessionStorage.getItem("vp_correo") || localStorage.getItem("vp_correo") || "";
  if(n) $("#nombre").value = n;
  if(c){ $("#correo").value = c; $("#correo2").value = c; }
  actualizarEstado();
});
</script>
</body>
</html>
